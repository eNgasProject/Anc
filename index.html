<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn Ngas</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <header class="header">
    <span class="logo">Learn Ngas</span>
    <button class="menu-btn" onclick="toggleSidebar()">Menu</button>
  </header>

  <div id="sidebar" class="sidebar">
    <div class="sidebar-header">
      <button class="close-btn" onclick="toggleSidebar()">Close</button>
    </div>
    <div class="sidebar-links">
      <button onclick="showScreen('home'); toggleSidebar()">Home</button>
      <button onclick="showScreen('vocabulary'); toggleSidebar()">Vocabulary</button>
    </div>
  </div>
  <div id="backdrop" class="backdrop" onclick="toggleSidebar()"></div>

  <section id="home" class="screen">
    <h2>Word of the Day</h2>
    <div class="word-card">
      <h3 id="wotd-ngas">Loading...</h3>
      <p id="wotd-english"></p>
      <audio id="wotd-audio" controls></audio>
      <img id="wotd-image" alt="Word image">
      <p id="wotd-meaning"></p>
    </div>
  </section>

  <section id="vocabulary" class="screen hidden">
    <h2>Vocabulary</h2>
    <input type="text" id="search" placeholder="Search...">
    <div id="word-list"></div>
  </section>

  <script>
    const appState = { words: [] };

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('active');
      document.getElementById('backdrop').classList.toggle('active');
    }

    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }

    async function loadData() {
      try {
        const res = await fetch('./data.json');
        if (!res.ok) throw new Error('Network response failed.');
        const data = await res.json();
        appState.words = data;
        initWordOfTheDay();
        displayWords(data);
      } catch (e) {
        alert('Failed to load data: ' + e.message);
      }
    }

    function initWordOfTheDay() {
      const word = appState.words[Math.floor(Math.random() * appState.words.length)];
      document.getElementById('wotd-ngas').textContent = word.Ngas_Word;
      document.getElementById('wotd-english').textContent = word.English;
      document.getElementById('wotd-meaning').textContent = word.Meaning;
      document.getElementById('wotd-audio').src = word.Audio || '';
      document.getElementById('wotd-image').src = word.image || '';
    }

    function displayWords(words) {
      const list = document.getElementById('word-list');
      list.innerHTML = '';
      words.forEach(w => {
        const card = document.createElement('div');
        card.className = 'word-card';
        card.innerHTML = `<h3>${w.Ngas_Word}</h3><p>${w.English}</p>`;
        list.appendChild(card);
      });
    }

    document.getElementById('search').addEventListener('input', e => {
      const term = e.target.value.toLowerCase();
      const filtered = appState.words.filter(w => w.Ngas_Word.toLowerCase().includes(term) || w.English.toLowerCase().includes(term));
      displayWords(filtered);
    });

    document.addEventListener('DOMContentLoaded', loadData);
  </script>
</body>
</html>
